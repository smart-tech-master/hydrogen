import{r as L,j as o}from"./jsx-runtime-CASrxSZM.js";import{j as I,O as H,Z as J}from"./index-BsAApm54.js";import{u as X,P as k}from"./Aside-BciJRqcJ.js";import{I as G}from"./Image-Cb8ns8_Z.js";import{A as Q,L as q,u as z}from"./components-DUsmJGLL.js";import"./Money-BJlzSldM.js";const g=",",f={OPTION:":",END_OF_PREFIX:",",SEQUENCE_GAP:" ",RANGE:"-"},_=(()=>{const t=new Map;return function(e,s){var n;if(e.length===0)return!1;if(!t.has(s)){const r=new Set;for(const i of M(s)){r.add(i.join(g));for(let a=0;a<i.length;a++)r.add(i.slice(0,a+1).join(g))}t.set(s,r)}return!!((n=t.get(s))!=null&&n.has(e.join(g)))}})();function M(t){if(!t)return[];if(t.startsWith("v1_"))return W(B(t));throw new Error("Unsupported option value encoding")}const B=t=>t.replace(/^v1_/,"");function W(t){const e=/[ :,-]/g;let s=0,n;const r=[],i=[];let a=0,l=null;for(;n=e.exec(t);){const c=n[0],d=Number.parseInt(t.slice(s,n.index))||0;if(l!==null){for(;l<d;l++)i[a]=l,r.push([...i]);l=null}i[a]=d,c===f.RANGE?l=d:c===f.OPTION?a++:((c===f.SEQUENCE_GAP||c===f.END_OF_PREFIX&&t[n.index-1]!==f.END_OF_PREFIX)&&r.push([...i]),c===f.END_OF_PREFIX&&(i.pop(),a--)),s=e.lastIndex}const u=t.match(/\d+$/g);if(u){const c=parseInt(u[0]);if(l!=null)for(;l<=c;l++)i[a]=l,r.push([...i]);else r.push([c])}return r}function Z(t){return Object.assign({},...t.map(e=>({[e.name]:Object.assign({},...e!=null&&e.optionValues?e.optionValues.map((s,n)=>({[s.name]:n})):[])})))}function x(t){return Object.assign({},...t.map(e=>({[e.name]:e.value})))}function S(t){return JSON.stringify(x(t))}function w(t){return Array.isArray(t)?JSON.stringify(Object.assign({},...t.map(e=>({[e.name]:e.value})))):JSON.stringify(t)}function Y(t,e){return Object.keys(t).map(n=>e[n]?e[n][t[n]]:null).filter(n=>n!==null)}function tt(t){return Object.assign({},...t.map(e=>({[w(e.selectedOptions||[])]:e})))}const R=["options","selectedOrFirstAvailableVariant","adjacentVariants"],et=["handle","encodedVariantExistence","encodedVariantAvailability"];function m(t){return console.error(`[h2:error:getProductOptions] product.${t} is missing. Make sure you query for this field from the Storefront API.`),!1}function F(t,e=!1){var s;let n=!0;const r=Object.keys(t);if((e?[...R,...et]:R).forEach(i=>{r.includes(i)||(n=m(i))}),t.options){const i=t==null?void 0:t.options[0];if(e&&!(i!=null&&i.name)&&(n=m("options.name")),(s=t==null?void 0:t.options[0])!=null&&s.optionValues){let a=t.options[0].optionValues[0];e&&!(a!=null&&a.name)&&(n=m("options.optionValues.name")),a=t.options[0].optionValues.filter(l=>!!(l!=null&&l.firstSelectableVariant))[0],a!=null&&a.firstSelectableVariant&&(n=y(a.firstSelectableVariant,"options.optionValues.firstSelectableVariant",n,e))}else n=m("options.optionValues")}return t.selectedOrFirstAvailableVariant&&(n=y(t.selectedOrFirstAvailableVariant,"selectedOrFirstAvailableVariant",n,e)),t.adjacentVariants&&t.adjacentVariants[0]&&(n=y(t.adjacentVariants[0],"adjacentVariants",n,e)),n?t:{}}function y(t,e,s,n){var r;let i=s;if(n&&!((r=t.product)!=null&&r.handle)&&(i=m(`${e}.product.handle`)),t.selectedOptions){const a=t.selectedOptions[0];a!=null&&a.name||(i=m(`${e}.selectedOptions.name`)),a!=null&&a.value||(i=m(`${e}.selectedOptions.value`))}else i=m(`${e}.selectedOptions`);return i}function nt(t){const e=F(t);if(!e.options)return[];const s={};e.options.map(r=>{var i;(i=r.optionValues)==null||i.map(a=>{if(a.firstSelectableVariant){const l=S(a.firstSelectableVariant.selectedOptions);s[l]=a.firstSelectableVariant}})}),e.adjacentVariants.map(r=>{const i=S(r.selectedOptions);s[i]=r});const n=e.selectedOrFirstAvailableVariant;if(n){const r=S(n.selectedOptions);s[r]=n}return Object.values(s)}function rt(t){const e=F(t,!0);if(!e.options)return[];const{options:s,selectedOrFirstAvailableVariant:n,adjacentVariants:r,encodedVariantExistence:i,encodedVariantAvailability:a,handle:l}=e,u=n==null?void 0:n.selectedOptions.map(p=>p.name),c=s.filter(p=>u&&u.indexOf(p.name)>=0),d=Z(s),v=tt(n?[n,...r]:r),j=x(n?n.selectedOptions:[]);return c.map((p,U)=>({...p,optionValues:p.optionValues.map(b=>{var E;const P={...j};P[p.name]=b.name;const $=w(P||[]),A=Y(P||[],d).slice(0,U+1),D=_(A,i||""),K=_(A,a||""),O=v[$]||b.firstSelectableVariant;let N={};O&&(N=x(O.selectedOptions||[]));const C=new URLSearchParams(N),V=((E=O==null?void 0:O.product)==null?void 0:E.handle)||l;return{...b,variant:O,handle:V,variantUriQuery:C.toString(),selected:j[p.name]===b.name,exists:D,available:K,isDifferentProduct:V!==l}})}))}function it(t){return L.useEffect(()=>{const e=new URLSearchParams(x(t||[])),s=new URLSearchParams(window.location.search),n=new URLSearchParams({...Object.fromEntries(s),...Object.fromEntries(e)});n.size>0&&window.history.replaceState({},"",`${window.location.pathname}?${n.toString()}`)},[JSON.stringify(t)]),null}function st({image:t}){return t?o.jsx("div",{className:"product-image",children:o.jsx(G,{alt:t.altText||"Product Image",aspectRatio:"1/1",data:t,sizes:"(min-width: 45em) 50vw, 100vw"},t.id)}):o.jsx("div",{className:"product-image"})}function ot({analytics:t,children:e,disabled:s,lines:n,onClick:r}){return o.jsx(I,{route:"/cart",inputs:{lines:n},action:I.ACTIONS.LinesAdd,children:i=>o.jsxs(o.Fragment,{children:[o.jsx("input",{name:"analytics",type:"hidden",value:JSON.stringify(t)}),o.jsx("button",{type:"submit",onClick:r,disabled:s??i.state!=="idle",children:e})]})})}function at({productOptions:t,selectedVariant:e}){const s=Q(),{open:n}=X();return o.jsxs("div",{className:"product-form",children:[t.map(r=>r.optionValues.length===1?null:o.jsxs("div",{className:"product-options",children:[o.jsx("h5",{children:r.name}),o.jsx("div",{className:"product-options-grid",children:r.optionValues.map(i=>{const{name:a,handle:l,variantUriQuery:u,selected:c,available:d,exists:v,isDifferentProduct:j,swatch:h}=i;return j?o.jsx(q,{className:"product-options-item",prefetch:"intent",preventScrollReset:!0,replace:!0,to:`/products/${l}?${u}`,style:{border:c?"1px solid black":"1px solid transparent",opacity:d?1:.3},children:o.jsx(T,{swatch:h,name:a})},r.name+a):o.jsx("button",{type:"button",className:`product-options-item${v&&!c?" link":""}`,style:{border:c?"1px solid black":"1px solid transparent",opacity:d?1:.3},disabled:!v,onClick:()=>{c||s(`?${u}`,{replace:!0,preventScrollReset:!0})},children:o.jsx(T,{swatch:h,name:a})},r.name+a)})}),o.jsx("br",{})]},r.name)),o.jsx(ot,{disabled:!e||!e.availableForSale,onClick:()=>{n("cart")},lines:e?[{merchandiseId:e.id,quantity:1,selectedVariant:e}]:[],children:e!=null&&e.availableForSale?"Add to cart":"Sold out"})]})}function T({swatch:t,name:e}){var r,i;const s=(i=(r=t==null?void 0:t.image)==null?void 0:r.previewImage)==null?void 0:i.url,n=t==null?void 0:t.color;return!s&&!n?e:o.jsx("div",{"aria-label":e,className:"product-option-label-swatch",style:{backgroundColor:n||"transparent"},children:!!s&&o.jsx("img",{src:s,alt:e})})}const Ot=({data:t})=>[{title:`Hydrogen | ${(t==null?void 0:t.product.title)??""}`},{rel:"canonical",href:`/products/${t==null?void 0:t.product.handle}`}];function vt(){const{product:t}=z(),e=H(t.selectedOrFirstAvailableVariant,nt(t));it(e.selectedOptions);const s=rt({...t,selectedOrFirstAvailableVariant:e}),{title:n,descriptionHtml:r}=t;return o.jsxs("div",{className:"product",children:[o.jsx(st,{image:e==null?void 0:e.image}),o.jsxs("div",{className:"product-main",children:[o.jsx("h1",{children:n}),o.jsx(k,{price:e==null?void 0:e.price,compareAtPrice:e==null?void 0:e.compareAtPrice}),o.jsx("br",{}),o.jsx(at,{productOptions:s,selectedVariant:e}),o.jsx("br",{}),o.jsx("br",{}),o.jsx("p",{children:o.jsx("strong",{children:"Description"})}),o.jsx("br",{}),o.jsx("div",{dangerouslySetInnerHTML:{__html:r}}),o.jsx("br",{})]}),o.jsx(J.ProductView,{data:{products:[{id:t.id,title:t.title,price:(e==null?void 0:e.price.amount)||"0",vendor:t.vendor,variantId:(e==null?void 0:e.id)||"",variantTitle:(e==null?void 0:e.title)||"",quantity:1}]}})]})}export{vt as default,Ot as meta};
